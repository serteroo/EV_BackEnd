{% extends "base.html" %}
{% block title %}Mediciones · EcoEnergy{% endblock %}

{% block content %}
  <h1 class="h4">Listado global de mediciones</h1>
  <span class="muted">Máximo 20 por página, ordenadas por fecha (desc.).</span>

  <div class="box" style="margin-top:12px;">
    <div class="table-responsive">
      <table class="table" style="width:100%;">
        <thead>
          <tr>
            <th style="width:180px;">Fecha / Hora</th>
            <th>Valor</th>
            <th>Dispositivo</th>
            <th class="right" style="width:140px;">Detalle</th>
          </tr>
        </thead>
        <tbody>
          {% for m in page_obj.object_list %}
            <tr>
              <td>{{ m.timestamp|date:"Y-m-d H:i" }}</td>
              <td>
                <span class="badge">{{ m.value }}</span>
                {% if m.unit %}<span class="muted">{{ m.unit }}</span>{% endif %}
              </td>
              <td>{{ m.device.name }}</td>
              <td class="right">
                <a class="btn" href="{% url 'device_detail' m.device.pk %}">Ver dispositivo</a>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="4" class="muted" style="text-align:center;padding:16px;">
                No hay mediciones registradas.
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Controles de paginación -->
    <div class="row" style="justify-content:space-between; align-items:center; margin-top:8px;">
      <div>
        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
      </div>
      <div>
        {% if page_obj.has_previous %}
          <a class="btn" href="?page={{ page_obj.previous_page_number }}">« Anterior</a>
        {% else %}
          <span class="btn disabled">« Anterior</span>
        {% endif %}

        {% if page_obj.has_next %}
          <a class="btn" href="?page={{ page_obj.next_page_number }}">Siguiente »</a>
        {% else %}
          <span class="btn disabled">Siguiente »</span>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
